# ==========================================
#  PRODUCTION - Salon Coiffure Backend
# ==========================================

# -------- Database (Neon / PostgreSQL) --------
spring.datasource.url=${NEON_DATABASE_URL}
spring.datasource.username=${NEON_USERNAME}
spring.datasource.password=${NEON_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# -------- JPA / Hibernate --------
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.open-in-view=false
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false

# Performances JPA
spring.jpa.properties.hibernate.jdbc.batch_size=25
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true

# -------- HikariCP --------
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=10
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# ==========================================
#  Server & Session
# ==========================================
server.port=${PORT:8080}
server.servlet.session.timeout=30m
server.servlet.session.cookie.secure=true
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.same-site=strict
# Erreurs (ne pas divulguer en prod)
server.error.include-stacktrace=never
server.error.include-message=never
server.error.include-binding-errors=never
server.error.include-exception=false

# Compression HTTP (réduit la latence/coût)
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,application/json,application/javascript,application/xml
server.compression.min-response-size=1024

# Proxies / Load balancers (si déployé derrière un LB)
server.forward-headers-strategy=framework

# ==========================================
#  Actuator (minimal, non bavard)
# ==========================================
management.endpoints.web.exposure.include=health,info
management.endpoint.health.probes.enabled=true
management.endpoint.health.show-details=never

# ==========================================
#  Logging
# ==========================================
logging.level.root=WARN
logging.level.com.salon.coiffure=INFO
logging.level.org.springframework.security=WARN
logging.level.org.hibernate.SQL=WARN
logging.level.org.springframework.boot.autoconfigure.security=ERROR

# ==========================================
#  DevTools (désactivé en prod)
# ==========================================
spring.devtools.add-properties=false
spring.devtools.restart.enabled=false
spring.devtools.livereload.enabled=false
